<!DOCTYPE html>
<html lang="ar">
  <style>
body {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
  background: #1e1e1e;
  color: white;
  display: flex;
  height: 100vh;
}

.sidebar {
  width: 220px; /* Ù‚Ù„Ù„Ù†Ø§ Ø§Ù„Ø¹Ø±Ø¶ */
  background: #111;
  padding: 15px;
  box-sizing: border-box;
}

.sidebar button {
  display: block;
  width: 100%;
  margin-bottom: 10px;
  padding: 12px;
  background: #198754;
  border: none;
  border-radius: 6px;
  color: white;
  font-size: 15px;
  cursor: pointer;
}

.chat-container {
  flex: 1; /* ÙŠØ§Ø®Ø° Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø© */
  display: flex;
  flex-direction: column;
  padding: 20px;
  overflow-y: auto;
}

.message {
  max-width: 70%;
  padding: 10px 14px;
  border-radius: 10px;
  margin: 8px 0;
}

.user {
  background: #198754;
  align-self: flex-end;
}

.bot {
  background: #333;
  align-self: flex-start;
}
</style>
  <head>
  <meta charset="UTF-8">
  <title>Ø¯Ø±Ø¯Ø´Ø© AI</title>
  <style>
    body { margin: 0; font-family: "Segoe UI", Arial, sans-serif; background: #0d1117; color: #e6edf3; display: flex; height: 100vh; }
    .sidebar { width: 220px; background: #161b22; padding: 20px; border-right: 1px solid #30363d; }
    .sidebar h2 { font-size: 18px; margin-bottom: 15px; }
    .sidebar button { width: 100%; margin: 5px 0; padding: 8px; border: none; background: #238636; color: #fff; cursor: pointer; border-radius: 5px; }
    .sidebar button:hover { background: #2ea043; }
    .chat-container { flex: 1; display: flex; flex-direction: column; }
    .chat-box { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
    .message { max-width: 70%; padding: 10px 15px; border-radius: 10px; line-height: 1.4; }
    .user { align-self: flex-end; background: #238636; color: #fff; border-bottom-right-radius: 0; }
    .bot { align-self: flex-start; background: #30363d; border-bottom-left-radius: 0; }
    .input-area { display: flex; padding: 15px; background: #161b22; border-top: 1px solid #30363d; }
    #userInput { flex: 1; padding: 10px; border-radius: 5px; border: 1px solid #30363d; background: #0d1117; color: #e6edf3; }
    button.send { margin-left: 10px; padding: 10px 20px; background: #238636; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
    button.send:hover { background: #2ea043; }
    .typing { font-style: italic; color: #8b949e; }
  </style>
</head>
<body>

  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
  <div class="sidebar">
    <h2>ğŸ’¡ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</h2>
    <button onclick="quickSend('Ø§Ø´Ø±Ø­Ù„ÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨Ø¨Ø³Ø§Ø·Ø©')">Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</button>
    <button onclick="quickSend('Ø£ÙƒØªØ¨Ù„ÙŠ Ø®Ø·Ø© Ù…Ø°Ø§ÙƒØ±Ø© ÙØ¹Ø§Ù„Ø©')">Ø®Ø·Ø© Ù…Ø°Ø§ÙƒØ±Ø©</button>
    <button onclick="quickSend('Ø§Ø¹Ø·ÙŠÙ†ÙŠ ÙˆØµÙØ© Ø³Ù‡Ù„Ø© Ù„Ù„Ø¹Ø´Ø§Ø¡')">ÙˆØµÙØ§Øª</button>
    <button onclick="quickSend('Ù†ÙƒØªØ© ØªØ¶Ø­ÙƒÙ†ÙŠ ğŸ˜‚')">Ù†ÙƒØªØ©</button>
  </div>

  <!-- Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->
  <div class="chat-container">
    <div id="chatBox" class="chat-box"></div>

    <div class="input-area">
      <input id="userInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§... ÙˆØ§Ø¶ØºØ· Enter">
      <button class="send" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
  </div>

  <script>
    const chatBox = document.getElementById("chatBox");
    const input = document.getElementById("userInput");

    function addMessage(text, sender) {
      const msg = document.createElement("div");
      msg.classList.add("message", sender);
      msg.innerText = text;
      chatBox.appendChild(msg);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function sendMessage(msg) {
      const message = msg || input.value;
      if (!message) return;

      addMessage(message, "user");
      input.value = "";

      const typing = document.createElement("div");
      typing.classList.add("typing");
      typing.innerText = "Ø§Ù„Ø°ÙƒØ§Ø¡ ÙŠÙƒØªØ¨...";
      chatBox.appendChild(typing);
      chatBox.scrollTop = chatBox.scrollHeight;

      try {
        const res = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message }),
        });

        const data = await res.json();
        typing.remove();

        if (data.reply) {
          typeEffect(data.reply, "bot");
        } else {
          addMessage("âš ï¸ Ù…Ø§ ÙÙŠ Ø±Ø¯", "bot");
        }
      } catch (err) {
        typing.remove();
        addMessage("âš ï¸ Ø®Ø·Ø£: " + err.message, "bot");
      }
    }

    // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙƒØªØ§Ø¨Ø©
    function typeEffect(text, sender) {
      let i = 0;
      const interval = setInterval(() => {
        const lastMsg = document.createElement("div");
        lastMsg.classList.add("message", sender);
        lastMsg.innerText = text.slice(0, i);
        if (chatBox.lastChild?.classList.contains(sender)) {
          chatBox.removeChild(chatBox.lastChild);
        }
        chatBox.appendChild(lastMsg);
        chatBox.scrollTop = chatBox.scrollHeight;
        i++;
        if (i > text.length) clearInterval(interval);
      }, 20);
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø§Ù„Ù€ Enter
    input.addEventListener("keypress", (e) => {
      if (e.key === "Enter") sendMessage();
    });

    // Ø±Ø³Ø§Ø¦Ù„ Ø³Ø±ÙŠØ¹Ø© Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    function quickSend(text) {
      input.value = text;
      sendMessage();
    }
  </script>
</body>
</html>